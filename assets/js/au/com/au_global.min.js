function fnCheckIntegerKey(a,b,c){var d=a.keyCode?a.keyCode:a.which?a.which:a.charCode;if((47>=d||d>=58)&&46!=d&&8!=d&&9!=d&&37!=d&&39!=d)return!1;if(null!=b&&null!=c){var e=document.getElementById(b),f=document.getElementById(c),g=a.srcElement?a.srcElement:a.target;if(9!=d&&g&&!g.readOnly){e.value="",f.value="";var h=document.getElementById("message");null!=h&&(h.value="")}}return!0}function fnCheckSpaceKey(a){var b=a.keyCode?a.keyCode:a.which?a.which:a.charCode;return 32==b?!1:!0}function fnCheckItemQty(a){var b=a.value;return 0==b?(alert("You must specify a quantity for this item. Please use the drag option to remove this wine from the preview section and place it in the alternative wine section."),a.value="",a.focus(),!1):!0}function empty(a){return"undefined"===a?!0:null==a?!0:""==a?!0:0==a.length?!0:!1}function trim(a){return a.replace(/^\s+|\s+$/g,"")}function fnTrimEmail(a){var b=document.getElementById(a);null!=b&&(b.value=trim(b.value))}function containsElement(a){for(var b=!1,c=0;!b&&c<a.length;)"."==a[c]||"%"==a[c]||"'"==a[c]?b=!0:c++;return b}function copyShippingFinal(a){null!=document.getElementById("salutation"+a)&&(document.getElementById("salutationFinal").value=document.getElementById("salutation"+a).value),null!=document.getElementById("firstName"+a)&&(document.getElementById("firstNameFinal").value=document.getElementById("firstName"+a).value),null!=document.getElementById("lastName"+a)&&(document.getElementById("lastNameFinal").value=document.getElementById("lastName"+a).value),null!=document.getElementById("houseNumber"+a)?document.getElementById("houseNumberFinal").value=document.getElementById("houseNumber"+a).value:null!=document.getElementById("houseNumberFinal")&&(document.getElementById("houseNumberFinal").value=""),null!=document.getElementById("flatNumber"+a)?document.getElementById("flatNumberFinal").value=document.getElementById("flatNumber"+a).value:null!=document.getElementById("flatNumberFinal")&&(document.getElementById("flatNumberFinal").value=""),null!=document.getElementById("companyName"+a)?document.getElementById("companyNameFinal").value=document.getElementById("companyName"+a).value:null!=document.getElementById("companyNameFinal")&&(document.getElementById("companyNameFinal").value=""),null!=document.getElementById("address1"+a)&&(document.getElementById("address1Final").value=document.getElementById("address1"+a).value),null!=document.getElementById("address2"+a)&&(document.getElementById("address2Final").value=document.getElementById("address2"+a).value),null!=document.getElementById("houseName"+a)?document.getElementById("houseNameFinal").value=document.getElementById("houseName"+a).value:null!=document.getElementById("houseNameFinal")&&(document.getElementById("houseNameFinal").value=""),null!=document.getElementById("postalCode"+a)&&(document.getElementById("postalCodeFinal").value=document.getElementById("postalCode"+a).value),null!=document.getElementById("city"+a)&&(document.getElementById("cityFinal").value=document.getElementById("city"+a).value),null!=document.getElementById("county"+a)?document.getElementById("countyFinal").value=document.getElementById("county"+a).value:null!=document.getElementById("countyFinal")&&(document.getElementById("countyFinal").value=""),null!=document.getElementById("state"+a)&&(document.getElementById("stateFinal").value=document.getElementById("state"+a).value,fnDisplayComplianceMsg("Y",document.getElementById("state"+a).value)),null!=document.getElementById("dayPhoneNumber"+a)&&(document.getElementById("dayPhoneNumberFinal").value=document.getElementById("dayPhoneNumber"+a).value),null!=document.getElementById("deliveryInstructions_"+a)&&(document.getElementById("deliveryInstructionFinal").value=document.getElementById("deliveryInstructions_"+a).value),null!=document.getElementById("deliveryInstructions_"+a)&&(document.getElementById("deliveryInstructions_1_final").value=document.getElementById("deliveryInstructions_1_"+a).value),null!=document.getElementById("deliveryInstructions_"+a)&&(document.getElementById("deliveryInstructions_2_final").value=document.getElementById("deliveryInstructions_2_"+a).value),null!=document.getElementById("deliveryInstructions_"+a)&&(document.getElementById("deliveryInstructions_3_final").value=document.getElementById("deliveryInstructions_3_"+a).value),null!=document.getElementById("deliveryInstructions_"+a)&&(document.getElementById("deliveryInstructions_4_final").value=document.getElementById("deliveryInstructions_4_"+a).value),$(".newaddress").each(function(a){var b,c,d=$(this).attr("checked");if(d||"true"==d){var e=$(this).val();null!=document.getElementById("myAccountSuccessURL")&&(b=$("#myAccountSuccessURL").val(),c=updateQueryStringParameter(b,"shipParam",e),$("#myAccountSuccessURL").val(c)),null!=document.getElementById("myAccountErrorURL")&&(b=$("#myAccountErrorURL").val(),c=updateQueryStringParameter(b,"shipParam",e),$("#myAccountErrorURL").val(c))}})}function updateQueryStringParameter(a,b,c){var d=new RegExp("([?|&])"+b+"=.*?(&|$)","i");return separator=-1!==a.indexOf("?")?"&":"?",a.match(d)?a.replace(d,"$1"+b+"="+c+"$2"):a+separator+b+"="+c}function fnShowShipForm(){null==document.getElementById("billingAdrsChkBox")||document.getElementById("billingAdrsChkBox").checked||null!=document.getElementById("shipForm")&&(document.getElementById("shipForm").style.display="block")}function fnSaveSkuId(a,b,c,d,e,f){null!=a&&(document.getElementById("selectedSku").value=a),"true"==b&&"true"==c&&(null!=document.getElementById("upgradePop")&&(document.getElementById("upgradePop").value="false"),fnInitiatePipeline(d,e,f,"true"))}function isEmpty(a){return!a||0===a.length}function copyCreditCardFinal(a){null!=document.getElementById("issueNumber"+a)&&null!=document.getElementById("issueNumberFinal")&&(document.getElementById("issueNumberFinal").value=document.getElementById("issueNumber"+a).value),null!=document.getElementById("startYear"+a)&&null!=document.getElementById("startYearFinal")&&(document.getElementById("startYearFinal").value=document.getElementById("startYear"+a).value),null!=document.getElementById("startMonth"+a)&&null!=document.getElementById("startMonthFinal")&&(document.getElementById("startMonthFinal").value=document.getElementById("startMonth"+a).value),null!=document.getElementById("cvv"+a)&&null!=document.getElementById("cvvNumberFinal")&&(document.getElementById("cvvNumberFinal").value=document.getElementById("cvv"+a).value),null!=document.getElementById("creditCardNumber"+a)&&(document.getElementById("creditCardNumberFinal").value=document.getElementById("creditCardNumber"+a).value),null!=document.getElementById("creditCardType"+a)&&(document.getElementById("creditCardTypeFinal").value=document.getElementById("creditCardType"+a).value),null!=document.getElementById("expirationMonth"+a)&&(document.getElementById("expirationMonthFinal").value=document.getElementById("expirationMonth"+a).value),null!=document.getElementById("expirationYear"+a)&&(document.getElementById("expirationYearFinal").value=document.getElementById("expirationYear"+a).value)}function fnValidate(a){var b=a.value;return containsElement(b)?(alert("Please enter only Numeric values."),a.value="",!1):!0}function goToDesiredPage(a){"Billing&ShippingAddress"==a&&(window.location.href="shipping_billing_address.jsp")}function redirect(a){window.location.href=a}function fnCheckCardType(a,b,c){var d=document.getElementById(a).value,e=document.getElementById(c),f=document.getElementById(b);return f.value="","AmericanExpress"==d?(e.setAttribute("maxLength",15),f.setAttribute("maxLength",4)):"Maestro"==d?(e.setAttribute("maxLength",19),f.setAttribute("maxLength",3)):(e.setAttribute("maxLength",16),f.setAttribute("maxLength",3)),!0}function fnCheckCvvLength(a,b){var c=document.getElementById(a).value,d=document.getElementById(b).value;"AmericanExpress"==d&&4!=c.length&&(alert("Please enter the 4 digit security code located on the front of your card"),document.getElementById(a).value=""),"AmericanExpress"!=d&&3!=c.length&&(alert("Please enter the 3 digit security code located on the back of your card"),document.getElementById(a).value="")}function fnCheckCvvLengthRC(a,b){var c=document.getElementById(a).value,d=document.getElementById(b).value,e=d.split("|"),f=!0;return"AmericanExpress"==e[2]&&4!=c.length&&(alert("Please enter the 4 digit security code located on the front of your card"),document.getElementById(a).value="",f=!1),"AmericanExpress"!=e[2]&&3!=c.length&&(alert("Please enter the 3 digit security code located on the back of your card"),document.getElementById(a).value="",f=!1),f?void(document.getElementById("cvvBeanValue").value=c):void 0}function populateCityState(a,b,c,d,e,f){return fnValidate(a)?void getCityState(a,document.getElementById(b),document.getElementById(c),d,e,f):(document.getElementById(b).value="",document.getElementById(c).value="",!1)}function populateMGMStateCity(a,b,c,d,e){return fnValidate(a)?void getCityStatehttp(a,document.getElementById(b),document.getElementById(c),complianceNeeded,e):(document.getElementById(b).value="",document.getElementById(c).value="",!1)}function fnComplianceMsg(a){var b;switch(a){case"Connecticut":return b=confirm("CT"),b===!0?!0:!1;case"Texas":return b=confirm("TX"),b===!0?!0:!1}}function fnConfirmAge(){var a,b,c=document.getElementById("confirmAge");if(null!=c&&!c.checked){if(null!=document.getElementById("ageVerifcationMess")){var d=document.getElementById("ageVerifcationMess").value;alert(d)}else alert("Please select the checkbox to acknowledge that you are at least 21 years old.");return!1}return null!=document.getElementById("state")&&(a=document.getElementById("state").value),0===a?(b=!0,1==b?!0:!1):null!=a&&"CA"==a||"1046"==a?(b=confirm("California law does not allow for free goods in conjunction with the sale of alcohol beverages. The cost of all advertised items in this offer are included in the advertised price. The invoice in your shipment will itemize the cost of each item included in your shipment.\n\nPress OK to continue"),1==b?!0:!1):null!=a&&"CT"==a||"1049"==a?(b=confirm(" Thank you for your order it will be forwarded to The Wine Cellar located in Wallingford, CT for processing and shipping.\n\n  Press OK to continue"),1==b?!0:!1):null!=a&&"VA"==a||"1039"==a?(b=confirm("By completing and submitting this form I understand that I am placing an order for wine with Connoisseur Encounters Co., Inc. d/b/a The Wine Cellar.\n\n\n Press OK to continue"),1==b?!0:!1):null!=a&&"IN"==a||"1025"==a?(b=confirm("Your order will be accepted and filled by a duly licensed retailer in your state.  Title to the wines that you have selected will pass to you upon the retailer's receipt of payment by credit card and  the wines properly packaged for shipment and delivery \n\nTherefore, as the purchaser you are directing carriers who are duly licensed by your applicable state agency, inclusive of FedEx, to act as your agents and on your behalf to have your wines picked up from the licensed retailer and delivered to the address specified in your order.    If you agree to this process, please click OK below.  As a reminder -- a person 21  years of age or older must be present and provide proper identification at the time of delivery in order to sign for the product\n\nPress OK to continue"),1==b?!0:!1):null!=a&&"NJ"==a||"1008"==a?(b=confirm("New Jersey law does not allow for free goods in conjunction with the sale of alcohol beverages. The cost of all advertised items in this offer are included in the advertised price. The invoice in your shipment will itemize the cost of each item included in your shipment.\n\nPress OK to continue"),1==b?!0:!1):null!=a&&"CO"==a||"1050"==a?(b=confirm("Colorado law does not allow for free goods in conjunction with the sale of alcohol beverages. The cost of all advertised items in this offer are included in the advertised price. The invoice in your shipment will itemize the cost of each item included in your shipment.\n\nPress OK to continue"),1==b?!0:!1):null!=a&&"TX"==a||"1033"==a?(b=confirm("If your order is accepted by one of the wineries below, they will then process and fulfill your wine order. \n\nHomestead Winery @ Grapevine\n\nHomestead Vineyards + Winery\n\nSunset Winery\n\nSalado Wine Seller\n\nPeach Creek Vineyards\n\nBrennan Vineyards\n\nPlease click OK to continue."),1==b?!0:!1):void 0}function populateLPMultiCityState(a,b,c,d,e,f){return fnValidate(a)?void getLPMultiCityState(a,document.getElementById(b),document.getElementById(c),d,e,f):(document.getElementById(b).value="",document.getElementById(c).value="",!1)}function fnGiftMsgDisplay(){var a=document.getElementsByName("giftRadio");document.getElementById("giftMsg").value="",null!=document.getElementById("giftMail")&&(document.getElementById("giftMail").value=""),a[0].checked?(document.getElementById("gift-message-box").style.display="block",null!=document.getElementById("gift-messageTo-box")&&(document.getElementById("gift-messageTo-box").style.display="block")):(document.getElementById("gift-message-box").style.display="none",null!=document.getElementById("gift-messageTo-box")&&(document.getElementById("gift-messageTo-box").style.display="none"))}function fnSelectCreditCard(){var a=document.getElementsByName("creditCardToUse"),b=document.getElementById("guestUser"),c=!1;if(null==b){var d=!1,e=$("input:checkbox[name=cashVoucherFlag]:checked").val();if(e){var f=parseInt($("#orderTotal").val()),g=parseInt($("#voucherAmount").val());if(g>f)d=!0,c=!0;else if(null!=a)for(var h=0;h<a.length;h++)if(a[h].checked){d=!0;break}}if(null!=a)for(var i=0;i<a.length;i++)if(a[i].checked){d=!0;break}if(!d&&!c)return alert("Please enter your Payment Details"),!1}var j=$("input[name=creditCardToUse]:checked").attr("id");return c?fnConfirmAge():""==$("#cvv_"+j).find("input:text[name='creditCardVerificationNumber']").val()?(alert("Please enter your CVV number"),!1):fnConfirmAge()}function copyDetails(a,b){document.getElementById("billingAdrsChkBox").checked?(null!=document.getElementById("shipForm")&&(document.getElementById("shipForm").style.display="none"),document.getElementById("shippingFirstName1").value=document.getElementById("firstName").value,document.getElementById("shippingLastName1").value=document.getElementById("lastName").value,document.getElementById("shippingCompanyName1").value=document.getElementById("billingAdrsCompany").value,document.getElementById("shippingAddress11").value=document.getElementById("billingAdrs1").value,document.getElementById("shippingAddress12").value=document.getElementById("billingAdrs2").value,document.getElementById("shippingZipCode1").value=document.getElementById("billZipCode").value,void 0===b&&fnDisplayComplianceMsg(a,document.getElementById("statecode").value),document.getElementById("shippingCity1").value=document.getElementById("city").value,document.getElementById("shippingState1").value=document.getElementById("statecode").value,document.getElementById("shippingDay1").value=document.getElementById("billingDay").value,document.getElementById("shippingEvening1").value=document.getElementById("billingEvening").value):void 0===b&&(null!=document.getElementById("shipForm")&&(document.getElementById("shipForm").style.display="block"),document.getElementById("shippingFirstName1").value="",document.getElementById("shippingLastName1").value="",document.getElementById("shippingCompanyName1").value="",document.getElementById("shippingAddress11").value="",null!=document.getElementById("shippingAddress12")&&(document.getElementById("shippingAddress12").value=""),document.getElementById("shippingZipCode1").value="",document.getElementById("shippingCity1").value="",document.getElementById("shippingState1").value="",document.getElementById("shippingDay1").value="",document.getElementById("shippingEvening1").value="")}function copyDetailsToShipping(a,b){document.getElementById("billingAdrsChkBox").checked?(null!=document.getElementById("shipForm")&&(document.getElementById("shipForm").style.display="none"),document.getElementById("shippingSalutation1").value=document.getElementById("salutation").value,null!=document.getElementById("firstName")?document.getElementById("shippingFirstName1").value=document.getElementById("firstName").value:document.getElementById("shippingFirstName1").value=document.getElementById("billingFirstName").value,null!=document.getElementById("lastName")?document.getElementById("shippingLastName1").value=document.getElementById("lastName").value:document.getElementById("shippingLastName1").value=document.getElementById("billingLastName").value,document.getElementById("shippingCompanyName1").value=document.getElementById("billingAdrsCompany").value,document.getElementById("shippingHouseNumber").value=document.getElementById("houseNumber").value,document.getElementById("shippingFlatNumber").value=document.getElementById("flatNumber").value,document.getElementById("shippingHouseName").value=document.getElementById("houseName").value,document.getElementById("shippingAddress1").value=document.getElementById("billingAdrs1").value,document.getElementById("shippingAddress2").value=document.getElementById("billingAdrs2").value,document.getElementById("shippingZipCode").value=document.getElementById("billZipCode").value,document.getElementById("shippingCity").value=document.getElementById("city").value,document.getElementById("shippingCounty").value=document.getElementById("county").value,document.getElementById("shippingDay1").value=document.getElementById("billingDay").value):void 0===b&&(null!=document.getElementById("shipForm")&&(document.getElementById("shipForm").style.display="block"),document.getElementById("shippingSalutation1").value="",document.getElementById("shippingFirstName1").value="",document.getElementById("shippingLastName1").value="",document.getElementById("shippingCompanyName1").value="",document.getElementById("shippingHouseNumber").value="",document.getElementById("shippingFlatNumber").value="",document.getElementById("shippingAddress1").value="",document.getElementById("shippingAddress2").value="",document.getElementById("shippingHouseName").value="",document.getElementById("shippingZipCode").value="",document.getElementById("shippingCity").value="",document.getElementById("shippingCounty").value="",document.getElementById("shippingDay1").value="")}function fnDisplayGiftMsg(){var a=document.getElementsByName("giftRadio_guest");a[0].checked?(document.getElementById("giftMessage_guest").style.display="block",null!=document.getElementById("giftEmail_guest")&&(document.getElementById("giftEmail_guest").style.display="block")):(document.getElementById("giftMsg_guest").value="",document.getElementById("giftMessage_guest").style.display="none",null!=document.getElementById("giftEmail_guest")&&(document.getElementById("giftMail_guest").value="",document.getElementById("giftEmail_guest").style.display="none"))}function fnValidateGiftMessage(){return document.getElementsByName("giftRadio_guest")[0].checked&&""==trim(document.getElementById("giftMsg_guest").value)?(alert("Please enter a gift message"),!1):void 0}function setWPID(a){document.getElementById("bWPId").value=a,document.wineplanbasicdetails.submit()}function handleNextDispatch(a,b){document.getElementById("bWPId").value=a,document.getElementById("bWPFreq").value=b,document.wineplanbasicdetails.action="${fragmentFinder.fragments.WPNextCaseDetailsFragment}",document.wineplanbasicdetails.submit()}function handleSubmit(a){document.getElementById("bWPId").value=a,document.wineplanbasicdetails.action="${fragmentFinder.fragments.WinePlanDetailsFragment}",document.wineplanbasicdetails.submit()}function recEmailValidation(a,b,c){var d=$("#email").val();$("#errorForExisting").hide(),$("#emailId").val(d);var e=new ajaxService,f={url:"/jsp/checkout/common/validateEmail.jsp",data:"email="+encodeURI(d)+"&isRECRpage="+c,successCallback:function(c,d){successrecEmailValidation(c,d,a,b)}};e.processAJAXRequest(f),$("#loginId").val($("#emailId").val())}function successrecEmailValidation(a,b,c,d){var e=trim(a).split("|"),f=e[0],g=(e[1],e[2]);1==f?"true"==c?null!=document.getElementById("messageForValidEmail")?(document.getElementById("messageForValidEmail").style.visibility="visible",document.getElementById("messageForValidEmail").style.display="block",null!=document.getElementById("customerNo")&&(document.getElementById("customerNo").style.display="none"),null!=document.getElementById("zip")&&(document.getElementById("zip").style.display="none"),null!=document.getElementById("confirm-order1")&&(document.getElementById("confirm-order1").style.display="none"),null!=document.getElementById("profileFound")&&(document.getElementById("profileFound").value="profileFound")):(null!=document.getElementById("customerNo")&&(document.getElementById("customerNo").style.display="none"),null!=document.getElementById("zip")&&(document.getElementById("zip").style.display="none"),null!=document.getElementById("confirm-order1")&&(document.getElementById("confirm-order1").style.display="block"),null!=document.getElementById("profileFound")&&(document.getElementById("profileFound").value="profileFound")):(document.getElementById("errorForExisting").style.display="block",document.getElementById("email").value="",null!=document.getElementById("confirm-order1")&&(document.getElementById("confirm-order1").style.display="block"),null!=document.getElementById("profileFound")&&(document.getElementById("profileFound").value=null)):("true"==c&&(null!=document.getElementById("messageForValidEmail")?(document.getElementById("messageForValidEmail").style.visibility="hidden",document.getElementById("messageForValidEmail").style.display="none","true"==d&&(null!=document.getElementById("customerNo")&&(document.getElementById("customerNo").style.display="block"),null!=document.getElementById("zip")&&(document.getElementById("zip").style.display="block"))):""==document.getElementById("brandAccount").value?"true"==d&&(null!=document.getElementById("customerNo")&&(document.getElementById("customerNo").style.display="block"),null!=document.getElementById("zip")&&(document.getElementById("zip").style.display="block")):(null!=document.getElementById("zip")&&(document.getElementById("zip").style.display="block"),document.getElementById("zip-verify").disabled=!1)),null!=document.getElementById("profileFound")&&(document.getElementById("profileFound").value=null),null!=document.getElementById("confirm-order1")&&(document.getElementById("confirm-order1").style.display="block"),$.ajax({type:"POST",url:"/jsp/offer/recr/us/common/recofferAjaxUnlimitedShipping.jsp",data:"profileItem="+g,success:function(a){var b=$("<div>").html(a).find(".unlimited-container").html();null!=$(".unlimited-ship-bill-container")&&$(".unlimited-ship-bill-container").html(b)},error:function(){}}))}function emailValidation(){null!=document.getElementById("email")&&null!=document.getElementById("emailId")&&(document.getElementById("emailId").value=document.getElementById("email").value,validateEmail(),document.getElementById("loginId").value=document.getElementById("emailId").value)}function fnONLoadGiftMsg(){null!=document.getElementById("onloadVal")?"true"==document.getElementById("onloadVal").value&&(document.getElementsByName("giftRadio_guest")[0].checked=!0,document.getElementById("giftMessage_guest").style.display="block",null!=document.getElementById("gift_msg_value")&&(document.getElementById("giftMsg_guest").value=document.getElementById("gift_msg_value").value),null!=document.getElementById("giftEmail_guest")&&(document.getElementById("giftEmail_guest").style.display="block",null!=document.getElementById("gift_msgTo_value")&&(document.getElementById("giftMail_guest").value=document.getElementById("gift_msgTo_value").value))):null!=document.getElementById("onloadValMailTo")&&"true"==document.getElementById("onloadValMailTo").value&&(document.getElementsByName("giftRadio_guest")[0].checked=!0,document.getElementById("giftMessage_guest").style.display="block",document.getElementById("giftMsg_guest").value=document.getElementById("gift_msg_value").value,document.getElementById("giftEmail_guest").style.display="block",document.getElementById("giftMail_guest").value=document.getElementById("gift_msgTo_value").value)}function fnDisplayGiftMsg_Reg(){document.getElementById("giftMsg").value="";var a=document.getElementsByName("giftRadio");a[0].checked?(document.getElementById("giftMessage").style.display="block",null!=document.getElementById("giftEmail")&&(document.getElementById("giftEmail").style.display="block")):(document.getElementById("giftMessage").style.display="none",null!=document.getElementById("giftEmail")&&(document.getElementById("giftMail").value="",document.getElementById("giftEmail").style.display="none"))}function fnValidateGiftMessage_Reg(){if(null!=document.getElementsByName("giftRadio")[0]&&null!=document.getElementById("giftMsg")){if(document.getElementsByName("giftRadio")[0].checked&&""==trim(document.getElementById("giftMsg").value))return alert("Please enter a message"),!1}else if(null!=document.getElementsByName("giftRadio_guest")[0]&&null!=document.getElementById("giftMsg_guest")&&document.getElementsByName("giftRadio_guest")[0].checked&&""==trim(document.getElementById("giftMsg_guest").value))return alert("Please enter a message"),!1}function fnDisplayGiftMsgOnload(){null!=document.getElementById("giftMsg")&&""!=document.getElementById("giftMsg").value?(document.getElementById("giftMessage").style.display="block",document.getElementsByName("giftRadio")[0].checked=!0,null!=document.getElementById("giftEmail")&&(document.getElementById("giftEmail").style.display="block")):null!=document.getElementById("giftMail")&&""!=document.getElementById("giftMail").value&&(document.getElementById("giftMessage").style.display="block",document.getElementsByName("giftRadio")[0].checked=!0,document.getElementById("giftEmail").style.display="block")}function fnDisplayLabelMsg(){var a,b=$("#displayLabelParam").val(),c=$("input:radio[name=labelRadio]:checked");"yes"==b&&!c.val()||"Y"==c.val()||"false"==c.val()?($("input:radio[name=labelRadio]")[0].checked=!0,a=!0):$("input:radio[name=labelRadio]")[1].checked=!0,a?(document.getElementById("labelMessage").style.display="block",null!=document.getElementById("viewLabelMessage")&&(document.getElementById("viewLabelMessage").value="true")):(document.getElementById("labelMessage").style.display="none",null!=document.getElementById("viewLabelMessage")&&(document.getElementById("viewLabelMessage").value="false"))}function fnDisplayData(a,b){var c,d=document.getElementById("salutation_"+a);"undefined"!=typeof d&&null!=d&&(document.getElementById("editShippingPrefix").value=document.getElementById("salutation_"+a).value),document.getElementById("editShippingFirstName").value=document.getElementById("firstName_"+a).value,document.getElementById("editShippingLastName").value=document.getElementById("lastName_"+a).value,null!=document.getElementById("houseNumber_"+a)&&(document.getElementById("editShippingHouseNumber").value=document.getElementById("houseNumber_"+a).value),null!=document.getElementById("flatNumber_"+a)&&(document.getElementById("editShippingFlatNumber").value=document.getElementById("flatNumber_"+a).value),null!=document.getElementById("houseName_"+a)&&(document.getElementById("editShippingHouseName").value=document.getElementById("houseName_"+a).value),b===!0?($("#edit-shipping-address #input-company").val($("#companyName_"+a).val()),$("#edit-shipping-address #input-addr1").val($("#address1_"+a).val()),$("#edit-shipping-address #input-addr2").val($("#address2_"+a).val()),$("#edit-shipping-address #input-zip").val($("#postalCode_"+a).val()),$("#edit-shipping-address #input-city").val($("#city_"+a).val()),null!=document.getElementById("state_"+a)&&null!=document.getElementById("state_"+a).value&&$("#edit-shipping-address #input-state").val($("#state_"+a).val()),$("#edit-shipping-address #editShippingDayPhone").val($("#shippingPhoneDay_"+a).val()),c=$("#addressType_"+a).val(),"Residential"==c?(document.getElementById("input-residential").value=c,document.getElementsByName("addrsType")[0].checked=!0):"Commercial"==c?(document.getElementById("input-commercial").value=c,document.getElementsByName("addrsType")[1].checked=!0):(document.getElementById("input-residential").value="Residential",document.getElementsByName("addrsType")[0].checked=!0)):(document.getElementById("editShippingCompanyName").value=document.getElementById("companyName_"+a).value,document.getElementById("editShippingAddress1").value=document.getElementById("address1_"+a).value,document.getElementById("editShippingAddress2").value=document.getElementById("address2_"+a).value,document.getElementById("editShippingZipCode").value=document.getElementById("postalCode_"+a).value,document.getElementById("editShippingCity").value=document.getElementById("city_"+a).value,null!=document.getElementById("state_"+a)&&null!=document.getElementById("state_"+a).value&&(document.getElementById("editShippingState").value=document.getElementById("state_"+a).value),document.getElementById("editShippingDayPhone").value=document.getElementById("shippingPhoneDay_"+a).value,c=document.getElementById("addressType_"+a).value,"Residential"==c?(document.getElementById("addressType_resi").value=c,document.getElementsByName("addrsType")[0].checked=!0):"Commercial"==c?(document.getElementById("addressType_comm").value=c,document.getElementsByName("addrsType")[1].checked=!0):(document.getElementById("addressType_resi").value="Residential",document.getElementsByName("addrsType")[0].checked=!0)),document.getElementById("info_id").value=document.getElementById("id_"+a).value}function fnDisplayDataForEdit(a){if(document.getElementById("editShippingPrefix").value=getFirstCharUpper(document.getElementById("prefix_"+a).value),document.getElementById("editShippingFirstName").value=document.getElementById("firstName_"+a).value,document.getElementById("editShippingLastName").value=document.getElementById("lastName_"+a).value,document.getElementById("editShippingCompanyName").value=document.getElementById("companyName_"+a).value,document.getElementById("editShippingHouseNumber").value=document.getElementById("houseNumber_"+a).value,document.getElementById("editShippingFlatNumber").value=document.getElementById("flatNumber_"+a).value,document.getElementById("editShippingAddress1").value=document.getElementById("address1_"+a).value,document.getElementById("editShippingAddress2").value=document.getElementById("address2_"+a).value,document.getElementById("editShippingHouseName").value=document.getElementById("houseName_"+a).value,document.getElementById("editShippingZipCode").value=document.getElementById("postalCode_"+a).value,document.getElementById("editShippingCity").value=document.getElementById("city_"+a).value,document.getElementById("editShippingCounty").value=document.getElementById("county_"+a).value,document.getElementById("editShippingDayPhone").value=document.getElementById("shippingPhoneDay_"+a).value,document.getElementById("editShippingDeliveryInstructions").value="",null!=document.getElementById("deliveryInstructions_1_"+a)&&(document.getElementById("editShippingDeliveryInstructions").value=document.getElementById("deliveryInstructions_1_"+a).value),""!=document.getElementById("editShippingDeliveryInstructions").value&&"-1"==document.getElementById("editShippingDeliveryInstructions").value){var b=document.getElementById("deliveryInstructions_1_"+a);"undefined"!=typeof b&&null!=b&&(document.getElementById("editShippingDeliveryInstructionsTxt1").value=document.getElementById("deliveryInstructions_1_"+a).value,document.getElementById("editShippingDeliveryInstructionsTxt2").value=document.getElementById("deliveryInstructions_2_"+a).value,document.getElementById("editShippingDeliveryInstructionsTxt3").value=document.getElementById("deliveryInstructions_3_"+a).value,
document.getElementById("editShippingDeliveryInstructionsTxt4").value=document.getElementById("deliveryInstructions_4_"+a).value),document.getElementById("optionotheredit").style.display="block"}else document.getElementById("optionotheredit").style.display="none";var c=document.getElementById("addressType_"+a).value;"Residential"==c?$("#addressType_resi").length>0&&(document.getElementById("addressType_resi").value=c,document.getElementsByName("addrsType")[0].checked=!0):"Commercial"==c?$("#addressType_comm").length>0&&(document.getElementById("addressType_comm").value=c,document.getElementsByName("addrsType")[1].checked=!0):$("#addressType_resi").length>0&&(document.getElementById("addressType_resi").value="Residential",document.getElementsByName("addrsType")[0].checked=!0),document.getElementById("info_id").value=document.getElementById("id_"+a).value}function getFirstCharUpper(a){if(null!=a&&""!=a){for(var b="",c=0;c<a.length;c++)b+=0==c?a.charAt(c).toUpperCase():a.charAt(c).toLowerCase();return b}return a}function fnCopySalutation(){document.getElementById("editBillingSalutation").value=getFirstCharUpper(document.getElementById("billingSalutation").value)}function fnCopyBillingShippingSalutation(){document.getElementById("billingAdrsChkBox").checked?document.getElementById("shippingSalutation1").value=document.getElementById("billingSalutation1").value:document.getElementById("shippingSalutation1").value=""}function fnSubmitCheckout(){document.forms.checkOut.submit()}function fnSubmitRemove(){document.forms.removeItem.submit()}function fnSubmitCoupon(){document.forms.Coupon.submit()}function fnSubmitUpdate(){document.forms.update.submit()}function fnSubmitQuickAddtoCart(){document.forms.quickAddtoCart.submit()}function fnEnable(){document.getElementById("zip-verify").disabled=!1,document.getElementById("zip-verify").value="please enter zipcode",document.getElementById("zip-verify").select()}function fnOnClickToPopulate(){populateMultiCityState(document.getElementById("editShippingZipCode"),"editShippingCity","editShippingState")}function fnOnClickToPopulateShipping(){populateCityState(document.getElementById("editShippingZipCode"),"editShippingCity","editShippingState")}function populateBillingAddress(a,b,c,d,e,f,g,h){emailObj=document.getElementById(a),fNameObj=document.getElementById(b),lNameObj=document.getElementById(c),brandAccountObj=document.getElementById(d),zipcodeObj=document.getElementById(e),null!=brandAccountObj&&""!=brandAccountObj.value&&(""!=lNameObj.value&&""!=brandAccountObj.value&&""!=zipcodeObj.value&&(fnResetBillAddr(),getBillingAddress(emailObj,fNameObj,lNameObj,brandAccountObj,zipcodeObj,f,g,h)),""!=lNameObj.value&&""!=zipcodeObj.value||1!=document.getElementById("billingAdrs1").readOnly?""==lNameObj.value&&alert("Some of the mandatory fields are missing. Please enter the values "):fnResetBillAddr())}function getCityState(a,b,c,d,e,f){var g=new ajaxService,h={url:"/jsp/checkout/common/cityStateFinder.jsp",data:"zipCode="+encodeURI(a.value),successCallback:function(g,h){successgetCityState(g,h,a,b,c,d,e,f)}};g.processAJAXRequest(h)}function successgetCityState(a,b,c,d,e,f,g,h){if(":"==trim(a))alert("Please enter a valid zipcode"),c.value="",d.value="",e.value="",c.focus();else{var i=trim(a).split(":");fnDisplayComplianceMsg(h,i[2]),d.value=i[0],e.value=i[1],c.focus(),null!=f&&"true"==f&&null!=g&&fnCheckCompliance(g)}}function getLPCityState(a,b,c,d,e,f){var g=new ajaxService,h={url:"/jsp/checkout/common/cityStateFinder.jsp",data:"zipCode="+encodeURI(a.value),successCallback:function(g,h){successgetLPCityState(g,h,a,b,c,d,e,f)}};g.processAJAXRequest(h)}function successgetLPCityState(a,b,c,d,e,f,g,h){if(":"==trim(a))alert("Please enter a valid zipcode"),c.value="",d.value="",e.value="",c.focus();else{var i=trim(a).split(":");fnDisplayComplianceMsg(h,i[2]),$("#cityField").show(),$("#stateField").show(),$("#cityField2").show(),$("#stateField2").show(),d.value=i[0],e.value=i[1],null!=f&&"true"==f&&null!=g&&fnCheckCompliance(g)}}function validateEmail(){var a=null;null!=$("#recEmailEnabled")&&(a=$("#recEmailEnabled").val());var b=$("#email").val(),c=new ajaxService,d={url:"/jsp/checkout/common/validateEmail.jsp",data:"email="+encodeURI(b),successCallback:function(b,c){successvalidateEmail(b,c,a)}};c.processAJAXRequest(d)}function successvalidateEmail(a,b,c){var d=trim(a).split("|"),e=d[0],f=d[1],g=d[2];1==c&&(1==e?null!=$("#messageForValidEmail")&&$("#messageForValidEmail").show():$("#messageForValidEmail").hide()),1==f?null!=$("#dateOfBirth")&&$("#dateOfBirth").hide():null!=$("#dateOfBirth")&&$("#dateOfBirth").show(),$.ajax({type:"POST",url:"/jsp/checkout/us/common/ajaxUnlimitedShipping.jsp",data:"profileItem="+g,success:function(a){var b=$("<div>").html(a).find(".unlimited-container").html();null!=$("#checkout-unlimited-shipping")&&$("#checkout-unlimited-shipping").html(b)},error:function(){}})}function getCityStatehttp(a,b,c,d,e){var f=new ajaxService,g={url:"/jsp/checkout/common/citystatefinderhttp.jsp",data:"zipCode="+encodeURI(a.value),successCallback:function(f,g){successgetCityStatehttp(f,g,a,b,c,d,e)}};f.processAJAXRequest(g)}function successgetCityStatehttp(a,b,c,d,e,f,g){if(":"==trim(a))alert("Please enter a valid zipcode"),c.value="",d.value="",e.value="",c.focus();else{var h=trim(a).split(":");d.value=h[0],e.value=h[1],null!=f&&"true"==f&&null!=g&&fnCheckCompliance(g)}}function validateEmailhttp(){var a=new ajaxService,b=document.getElementById("email").value,c={url:"/jsp/checkout/common/validateemailhttp.jsp",data:"email="+encodeURI(b),successCallback:function(a,b){successvalidateEmailhttp(a,b)}};a.processAJAXRequest(c)}function successvalidateEmailhttp(a,b){1==a?null!=document.getElementById("messageForValidEmail")?(document.getElementById("messageForValidEmail").style.display="block",null!=document.getElementById("customerNo")&&null!=document.getElementById("zip")&&(document.getElementById("customerNo").style.display="none",document.getElementById("zip").style.display="none")):(null!=document.getElementById("customerNo")&&(document.getElementById("customerNo").style.display="none"),document.getElementById("zip").style.display="none"):null!=document.getElementById("messageForValidEmail")?(document.getElementById("messageForValidEmail").style.display="none",null!=document.getElementById("customerNo")&&null!=document.getElementById("zip")&&(document.getElementById("customerNo").style.display="block",document.getElementById("zip").style.display="block")):""==document.getElementById("brandAccount").value?null!=document.getElementById("customerNo")&&null!=document.getElementById("zip")&&(document.getElementById("customerNo").style.display="block",document.getElementById("zip").style.display="block"):null!=document.getElementById("zip")&&null!=document.getElementById("zip-verify")&&(document.getElementById("zip").style.display="block",document.getElementById("zip-verify").disabled=!1)}function getBillingAddress(a,b,c,d,e,f,g,h){var i=!1;if(window.XMLHttpRequest?i=new XMLHttpRequest:window.ActiveXObject&&(i=new ActiveXObject("Microsoft.XMLHTTP")),i){var j="/jsp/checkout/common/billingaddresslookup.jsp",k=!1;j=j+"?lastName="+c.value,j=j+"&zipCode="+e.value,j=j+"&brandAccountNumber="+d.value,j=j+"&email="+a.value,j=j+"&firstName="+b.value,j=j+"&brand="+g,i.open("GET",j,!0),i.onreadystatechange=function(){try{4==i.readyState?200==i.status?("Virgin"==g&&"AU"==h&&(k=!0),parseMessages(i.responseXML,k)):(204==i.status||1223==i.status)&&("registration"==f?fnNewRegAlert():($("#txtHidBrandAccLookup").val("0"),"Virgin"===g?($("#brandacclookup").show(),$.colorbox({width:"600px",inline:!0,href:"#brandacclookup",onClosed:function(){clearValues()}})):(null===triggerOverlay&&(triggerOverlay=$("#brandacclookup").overlay({expose:{color:"#333",loadSpeed:200,opacity:.9},onClose:function(){clearValues()}})),triggerOverlay.data("overlay").load()))):2==i.readyState&&500==i.status&&("registration"==f?(alert("Sorry, service currently unavailable &mdash; please try again later"),c.value="",e.value="","block"==document.getElementById("customerNo").style.display&&(d.value="",e.disabled="true",null!=document.getElementById("messageForZip")&&(document.getElementById("messageForZip").style.display="none")),null!=document.getElementById("isBrandAcctValidated")&&(document.getElementById("isBrandAcctValidated").value="false")):null!=document.getElementById("isBrandAcctValidated")&&(document.getElementById("isBrandAcctValidated").value="false"))}catch(a){}},i.send(null)}}function clearValues(){var a=$("#txtHidBrandAccLookup");a.length>0&&("1"===a.val()?onClickYes():onClickNo()),$("#brandacclookup").hide()}function onClickYes(){var a=$("#zip-verify"),b=$("#customerNo"),c=null,d=$("#lastName");$("#brandAccount").length>0?c=$("#brandAccount"):$("#brandAccNum").length>0&&(c=$("#brandAccNum")),a.length>0&&a.attr("disabled",!0).val(""),d.length>0&&d.val(""),b.length>0&&b.is(":visible")&&null!=c&&c.val("")}function onClickNo(){var a=$("#zip-verify");a.length>0&&a.attr("disabled",!0).val("")}function getProductViewDetails(a){var b=new ajaxService,c={url:"/jsp/account/common/wpviewdetails.jsp",data:"currItemId="+a,successCallback:function(a,b){successgetProductViewDetails(a,b)}};b.processAJAXRequest(c)}function successgetProductViewDetails(a,b){var c=(new Map,a.replace(/^\s+|\s+$/g,""));"EMPTY"==c?(alert("No product information is available"),request.send(null)):alert(c)}function parseMessages(a,b){var c=a.getElementsByTagName("billingaddress")[0],d=c.childNodes[0],e=(d.getElementsByTagName("firstName")[0],d.getElementsByTagName("lastName")[0],d.getElementsByTagName("address1")[0]),f=d.getElementsByTagName("address2")[0],g=d.getElementsByTagName("zipCode")[0],h=d.getElementsByTagName("city")[0],i=d.getElementsByTagName("state")[0],j=d.getElementsByTagName("dayPhoneNumber")[0],k=d.getElementsByTagName("eveningPhoneNumber")[0],l=d.getElementsByTagName("isWinePlanCust")[0],m=d.getElementsByTagName("companyName")[0],n=d.getElementsByTagName("axCustomerNumber")[0],o=d.getElementsByTagName("salutation")[0],p=d.getElementsByTagName("county")[0],q=d.getElementsByTagName("country")[0],r=d.getElementsByTagName("houseNumber")[0],s=d.getElementsByTagName("flatNumber")[0],t=d.getElementsByTagName("houseName")[0];if(null!=document.getElementById("salutation")&&null!=o&&null!=o.childNodes[0]&&(document.getElementById("salutation").value=o.childNodes[0].nodeValue),null!=document.getElementById("county")&&null!=p&&null!=p.childNodes[0]&&(document.getElementById("county").value=p.childNodes[0].nodeValue),null!=document.getElementById("country")&&null!=q&&null!=q.childNodes[0]&&(document.getElementById("country").value=q.childNodes[0].nodeValue),null!=document.getElementById("houseNumber")&&null!=r&&null!=r.childNodes[0]&&(document.getElementById("houseNumber").value=r.childNodes[0].nodeValue),null!=document.getElementById("flatNumber")&&null!=s&&null!=s.childNodes[0]&&(document.getElementById("flatNumber").value=s.childNodes[0].nodeValue),null!=document.getElementById("houseName")&&null!=t&&null!=t.childNodes[0]&&(document.getElementById("houseName").value=t.childNodes[0].nodeValue),null!=document.getElementById("wineplanFlag")&&(document.getElementById("wineplanFlag").value=l.childNodes[0].nodeValue),document.getElementById("billingAdrs1").value=e.childNodes[0].nodeValue,null!=f.childNodes[0]&&(document.getElementById("billingAdrs2").value=f.childNodes[0].nodeValue),document.getElementById("billZipCode").value=g.childNodes[0].nodeValue,document.getElementById("city").value=h.childNodes[0].nodeValue,null!=document.getElementById("statecode")&&null!=i.childNodes[0]&&(document.getElementById("statecode").value=i.childNodes[0].nodeValue),b){var u=h.childNodes[0].nodeValue;getMultiCitySelect(document.getElementById("billZipCode"),document.getElementById("city"),document.getElementById("statecode"),u),document.getElementById("city").disabled=!0}if(null!=j.childNodes[0]){var v=j.childNodes[0].nodeValue,w=document.getElementById("billingDay");""!==v?(w.value=v.replace(/-/g,""),w.readOnly=!0):w.readOnly=!1}if(null!=k.childNodes[0]){var x=k.childNodes[0].nodeValue;document.getElementById("billingEvening").value=x.replace(/-/g,"")}null!=m.childNodes[0]&&(document.getElementById("billingAdrsCompany").value=m.childNodes[0].nodeValue),null!=document.getElementById("axCustomerNumber")&&null!=n&&null!=n.childNodes[0]&&(document.getElementById("axCustomerNumber").value=n.childNodes[0].nodeValue),document.getElementById("billingAdrs1").readOnly=!0,document.getElementById("billingAdrs2").readOnly=!0,document.getElementById("billZipCode").readOnly=!0,document.getElementById("city").readOnly=!0,document.getElementById("statecode").readOnly=!0,document.getElementById("billingEvening").readOnly=!0,document.getElementById("billingAdrsCompany").readOnly=!0,null!=document.getElementById("isBrandAcctValidated")&&(document.getElementById("isBrandAcctValidated").value="true")}function fnEnable(a){return null!=document.getElementById(a)&&""!=document.getElementById(a).value?(document.getElementById("zip-verify").disabled=!1,null!=document.getElementById("messageForZip")&&(document.getElementById("messageForZip").style.display="block"),document.getElementById("zip-verify").value="",void document.getElementById("zip-verify").select()):void(""==document.getElementById(a).value&&""!=document.getElementById("zip-verify").value&&1==document.getElementById("billingAdrs1").readOnly&&fnResetBillAddr())}function fnNewRegAlert(){alert("Sorry your surname or postcode do not match the details on that account. Please check and reenter, or go type your address below."),zipcodeObj.value="",lNameObj.value="","block"==document.getElementById("customerNo").style.display&&(brandAccountObj.value="",zipcodeObj.disabled="true",null!=document.getElementById("messageForZip")&&(document.getElementById("messageForZip").style.display="none"))}function checkBilling(a,b){var c;"true"==b&&(c=window.confirm("You've indicated that your shipping and billing addresses are the same. Please click OK if this is correct. Hit Cancel to enter a different address")),c&&(document.getElementById("createBillingAddrflag").value=c)}function fnDisplayCreditCardSelected(a){var b=document.getElementsByName(a);null!=b&&1==b.length&&(b[0].checked=!0)}function updateOptIn(a){console.log(a),console.log(encodeURI(a));var b=new ajaxService,c={url:"/jsp/updateOptIn.jsp",data:"email="+encodeURI(a),successCallback:function(a,b){successupdateOptIn(a,b),console.log(a)}};b.processAJAXRequest(c)}function successupdateOptIn(a,b){var c=a.replace(/^\s+|\s+$/g,"");"true"==c?null!=document.getElementById("optin")&&(document.getElementById("optin").value="true"):null!=document.getElementById("optin")&&(document.getElementById("optin").value="false");var d=$("#optin").val();$(".email-bronto").html("true"===d?"<p>Thank you, you have been subscribed.</p>":"<p>An error occured.</p>")}function checkButton(){var a=document.getElementsByName("skuselector");if(null!=a)for(var b=0;b<a.length;b++){var c=a[b].value;null!=document.getElementsByName(c)&&null!=document.getElementsByName(c)[0]&&(document.getElementsByName(c)[0].checked=!0)}}function fnResetBillAddr(){document.getElementById("billingAdrs1").readOnly=!1,null!=document.getElementById("billingAdrs2")&&(document.getElementById("billingAdrs2").readOnly=!1),document.getElementById("billZipCode").readOnly=!1,document.getElementById("billingDay").readOnly=!1,null!=document.getElementById("billingEvening")&&(document.getElementById("billingEvening").readOnly=!1),document.getElementById("billingAdrsCompany").readOnly=!1,document.getElementById("billingAdrs1").value="",null!=document.getElementById("billingAdrs2")&&(document.getElementById("billingAdrs2").value=""),document.getElementById("billZipCode").value="",document.getElementById("city").value="",null!=document.getElementById("statecode")&&(document.getElementById("statecode").value=""),document.getElementById("billingDay").value="",null!=document.getElementById("billingEvening")&&(document.getElementById("billingEvening").value=""),document.getElementById("billingAdrsCompany").value="",null!=document.getElementById("billingAdrsChkBox")&&(document.getElementById("billingAdrsChkBox").checked=!1,copyDetails())}function fnCheckBrandOnLoad(a,b,c){emailObj=document.getElementById(b),""!=a&&null!=emailObj&&""!=emailObj.value?("true"!=c?(document.getElementById("customerNo").style.display="block",document.getElementById("brandAccount").value=a):(document.getElementById("customerNo").style.display="none",document.getElementById("brandAccount").value=a),document.getElementById("zip").style.display="block",document.getElementById("zip-verify").disabled=!1,document.getElementById("billingAdrs1").readOnly=!0,document.getElementById("billingAdrs2").readOnly=!0,document.getElementById("billZipCode").readOnly=!0,document.getElementById("city").readOnly=!0,document.getElementById("statecode").readOnly=!0,document.getElementById("billingDay").readOnly=!0,document.getElementById("billingEvening").readOnly=!0,document.getElementById("billingAdrsCompany").readOnly=!0):null!=emailObj&&""!=emailObj.value&&validateEmail()}function fnSetChkboxValues(a){var b,c,d=document.getElementsByName("skuselector"),e=document.getElementsByName("allQuantities");if(null!=d&&null!=e&0!=e.length)for(var f=0;f<d.length;f++)1==d[f].checked&&(b+=d[f].value+"`",c+=e[f].value+"`");document.getElementById("modalSelected").value=a,"modalLogin"==a?(document.getElementById("chkboxvalue").value=b,document.getElementById("qtyvalue").value=c):"modalEdit"==a?(document.getElementById("editshipchkboxvalue").value=b,document.getElementById("editshipqtyvalue").value=c):"modalAdd"==a?(document.getElementById("addshipchkboxvalue").value=b,document.getElementById("addshipqtyvalue").value=c):"modalPayment"==a&&(document.getElementById("addpaymentchkboxvalue").value=b,document.getElementById("addpaymentqtyvalue").value=c),null!=document.getElementById("rfhskulist")&&null!=document.getElementById("b2cskulist")&&(document.getElementById("rfhskulist").value=b,document.getElementById("b2cskulist").value=b)}function fnReset(){var a=null,b=null,c=null,d=null;if(""!=document.getElementById("chkboxvalue").value||""!=document.getElementById("qtyvalue").value?(a=document.getElementById("chkboxvalue").value,b=document.getElementById("qtyvalue").value):""!=document.getElementById("editshipchkboxvalue").value||""!=document.getElementById("editshipqtyvalue").value?(a=document.getElementById("editshipchkboxvalue").value,b=document.getElementById("editshipqtyvalue").value):""!=document.getElementById("addshipchkboxvalue").value||""!=document.getElementById("addshipqtyvalue").value?(a=document.getElementById("addshipchkboxvalue").value,b=document.getElementById("addshipqtyvalue").value):(""!=document.getElementById("addpaymentchkboxvalue").value||""!=document.getElementById("addpaymentqtyvalue").value)&&(a=document.getElementById("addpaymentchkboxvalue").value,b=document.getElementById("addpaymentqtyvalue").value),null!=a){c=a.split("`"),d=b.split("`");for(var e=0;e<c.length-1;e++){var f=document.getElementsByName("skuselector"),g=document.getElementsByName("allQuantities");if(null!=f)for(var h=0;h<f.length;h++)f[h].value==c[e]&&(f[h].checked=!0,g[h].value=d[e])}}null!=document.getElementById("pageModal")&&(document.getElementById("pageModal").value=null)}function fnResetRadio(){var a=document.getElementById("radioValue");if(null!=a){var b=a.value,c=document.getElementsByName("skuselector");if(null!=c)for(var d=0;d<c.length;d++)d==b&&(c[d].checked=!0)}}function fnSetQty(){var a=document.getElementsByName("skuselector"),b=document.getElementsByName("allQuantities");if(null!=a)for(var c=0;c<a.length;c++)0==a[c].checked&&(b[c].value="")}function showCompMessage(){var a=document.getElementsByName("addressDisplay");for(iCount=0;iCount<a.length;iCount++)if(1==a[iCount].checked){var b=a[iCount].value,c=document.getElementById(b),d=c.value;"Virginia"==d&&alert("Please be advised that due to state of Virginia legislation,we can only ship 24 bottles to you each month");break}}function fnCheckCompliance(a){var b=new ajaxService,c=document.getElementById("billingZipCode"),d=document.getElementById("billingState"),e=document.getElementById("billingCity"),f={url:"/jsp/compliance/us/common/checkcompliance.jsp",data:"zipCode="+c.value+"&state="+d.value+"&city="+e.value+"&isWinePlanCust="+a,successCallback:function(a,b){successUpdateOptIn(a,b)}};b.processAJAXRequest(f)}function successUpdateOptIn(a,b){document.getElementById("message").value=trim(a)}function validateSubject(){var a=document.getElementById("SubjectList").value;return 0==a?(alert("Please select a valid Subject."),!1):void 0}function fnValidateEmailOnLoad(a){emailObj=document.getElementById(a),null!=emailObj&&""!=emailObj.value&&validateEmail()}function fnDisplayComplianceMsg(a,b){null!=a&&"Y"==a&&null!=b&&""!=b&&((" CT"==b||"Connecticut"==b||"1049"==b)&&alert(" Upon completion of this form, your order will be forwarded to The Wine Cellar located in Wallingford, CT for processing and shipping.\n\n  Press OK to continue"),("TX"==b||"Texas"==b||"1033"==b)&&alert("If your order is accepted by one of the wineries below, they will then process and fulfill your wine order. \n\nHomestead Vineyards + Winery\n\nSunset Winery\n\nSalado Winery\n\nPeach Creek\n\nPlease click OK to continue."))}function showRelated(){$("#related").html('<div class="loader" style="text-align:center;padding-top:30px;"><img src="/images/us/en/brands/wsj/wsj_ajax_loader_big.gif"/></div>');var a=document.getElementById("wineType").value,b=document.getElementById("appellation").value,c=document.getElementById("region").value;c=c.replace("'","&#39;");var d=document.getElementById("country").value,e=document.getElementById("grape").value,f=document.getElementById("vintage").value,g=document.getElementById("productId").value,h=document.getElementById("stateId").value,i=document.getElementById("priceList").value,j=document.getElementById("colourCode").value,k=new ajaxService,l={url:"/jsp/product/common/productStraightTabsnew.jsp",data:"wineType="+encodeURI(a)+"&appellation="+encodeURI(b)+"&region="+encodeURI(c)+"&country="+encodeURI(d)+"&grape="+encodeURI(e)+"&vintage="+encodeURI(f)+"&id="+encodeURI(g)+"&stateId="+encodeURI(h)+"&priceList="+encodeURI(i)+"&colourCode="+encodeURI(j),successCallback:function(a,b){successshowRelated(a,b)}};k.processAJAXRequest(l)}function successshowRelated(a,b){document.getElementById("related")&&(null!=a&&""!=a?document.getElementById("related").innerHTML=trim(a):document.getElementById("related").innerHTML="")}function showMixedTab(){var a=new ajaxService,b=document.getElementById("wineType").value,c=document.getElementById("appellation").value,d=document.getElementById("region").value;d=d.replace("'","&#39;");var e=document.getElementById("country").value,f=document.getElementById("grape").value,g=document.getElementById("vintage").value,h=document.getElementById("productId").value,i=document.getElementById("stateId").value,j=document.getElementById("priceList").value,k=document.getElementById("colourCode").value,l={url:"/jsp/product/common/productstraightmixedrelated.jsp",data:"wineType="+encodeURI(b)+"&appellation="+encodeURI(c)+"&region="+encodeURI(d)+"&country="+encodeURI(e)+"&grape="+encodeURI(f)+"&vintage="+encodeURI(g)+"&productId="+encodeURI(h)+"&stateId="+encodeURI(i)+"&priceList="+encodeURI(j)+"&colourCode="+encodeURI(k),successCallback:function(a,b){successshowMixedTab(a,b)}};a.processAJAXRequest(l)}function successshowMixedTab(a,b){null!=a&&""!=a&&$("#t-mixed").show()}function showMixedStraightRelated(){$("#mixedCases").html('<div class="loader" style="text-align:center;padding-top:30px;"><img src="/images/us/en/brands/wsj/wsj_ajax_loader_big.gif"/></div>');var a=$("#mixedCases").data("url");empty(a)&&(a="/jsp/product/common/productstraightmixedrelated.jsp");var b=document.getElementById("wineType").value,c=document.getElementById("appellation").value;c=replaceToASCII(c);var d=document.getElementById("region").value;d=replaceToASCII(d);var e=document.getElementById("country").value,f=document.getElementById("grape").value,g=document.getElementById("vintage").value,h=document.getElementById("productId").value,i=document.getElementById("stateId").value,j=document.getElementById("priceList").value,k=document.getElementById("colourCode").value,l=new ajaxService,m={url:a,data:"wineType="+encodeURI(b)+"&country="+encodeURI(e)+"&grape="+encodeURI(f)+"&vintage="+encodeURI(g)+"&productId="+encodeURI(h)+"&stateId="+encodeURI(i)+"&priceList="+encodeURI(j)+"&colourCode="+encodeURI(k)+"&appellation="+encodeURI(c)+"&region="+encodeURI(d),successCallback:function(a,b){successshowMixedStraightRelated(a,b),$(".carousel-contents").carousel({itemsPerPage:3,itemsPerTransition:3,speed:800}),$("#mixedCases .carousel-contents").carousel({itemsPerPage:3,itemsPerTransition:3,speed:800}),$(".carousel-contents").css("visibility","visible")}};l.processAJAXRequest(m)}function replaceToASCII(a){for(var b=a.length,c=[];b--;){var d=a[b].charCodeAt();32!=d&&(65>d||d>127||d>90&&97>d)?c[b]="&#"+d+";":c[b]=a[b]}return c.join("")}function successshowMixedStraightRelated(a,b){null!=a&&""!=a?($("#t-mixed").show(),document.getElementById("mixedCases").innerHTML=trim(a),document.getElementById("mixedCases").style.display="block"):document.getElementById("mixedCases").innerHTML=""}function showMixedRelated(){$("#related").html('<div class="loader" style="text-align:center;padding-top:30px;"><img src="/images/us/en/brands/wsj/wsj_ajax_loader_big.gif"/></div>');var a=document.getElementById("wineType").value,b=document.getElementById("appellation").value,c=document.getElementById("region").value;c=c.replace("'","&#39;");var d=document.getElementById("country").value,e=document.getElementById("grape").value,f=document.getElementById("vintage").value,g=document.getElementById("productId").value,h=document.getElementById("stateId").value,i=document.getElementById("priceList").value,j=document.getElementById("colourCode").value,k=new ajaxService,l={url:"/jsp/product/common/productMixedTabsnew.jsp",data:"wineType="+encodeURI(a)+"&appellation="+encodeURI(b)+"&region="+encodeURI(c)+"&country="+encodeURI(d)+"&grape="+encodeURI(e)+"&vintage="+encodeURI(f)+"&id="+encodeURI(g)+"&stateId="+encodeURI(h)+"&priceList="+encodeURI(i)+"&colourCode="+encodeURI(j),successCallback:function(a,b){successshowMixedRelated(a,b)}};k.processAJAXRequest(l)}function successshowMixedRelated(a,b){null!=a&&""!=a?document.getElementById("Mixed-Related").innerHTML=trim(a):document.getElementById("Mixed-Related").innerHTML=""}function fnSkuValue(){var a="",b=document.getElementsByName("skuselector");if(null!=b)for(var c=0;c<b.length;c++)if(b[c].checked){a=c;break}null!=document.getElementById("radioValue")&&(document.getElementById("radioValue").value=a)}function fnSetProductId(){var a=document.getElementsByName("wines");if(null!=a)for(var b=0;b<a.length;b++)if(a[b].checked){document.getElementById("selectedProd").value=a[b].id;break}}function validatenum(a){var b=a,c=a.length,d=b.charAt(10);if(11>c)return alert("Please enter a valid Virgin Elevate Number"),document.getElementById("txtthirdPartyNo")&&(document.getElementById("txtthirdPartyNo").value=""),!1;for(var e=new Array(9),f=new Array("6","5","4","3","8","7","6","5","4","3"),g=0;c-2>=g;g++){var h=b.charAt(g),i=f[g];e[g]=h*i}for(var j=0,k=0;k<e.length;k++)j=e[k]+j;var l=j%11;if(2>=l&&0==d)return!0;var m=11-l;return m!=d?(alert("Please enter a valid Virgin Elevate Number"),document.getElementById("txtthirdPartyNo")&&(document.getElementById("txtthirdPartyNo").value=""),!1):!0}function fnDisableButton(a,b){a.disabled=!0,"shipping"==b?document.forms.addShipping.submit():document.forms.addPayment.submit()}function validateatlantic(a){var b=a,c=a.length,d=b.charAt(10);if(11>c)return alert("Please enter a valid Virgin Atlantic Number"),document.getElementById("txtthirdPartyNo")&&(document.getElementById("txtthirdPartyNo").value=""),!1;for(var e=new Array(4),f=new Array(4),g=0,h=0,i=0,j=0,k=0;4>=k;k++)g=k+1,h=g-1,e[k]=2*b.charAt(k+g),f[k]=1*b.charAt(k+h),i=e[k]+i,j=f[k]+j;var l=0,m=j+i,n=m%10;return l=0!=n?10-n:0,d!=l?(alert("Please enter a valid Virgin Atlantic Number"),document.getElementById("txtthirdPartyNo")&&(document.getElementById("txtthirdPartyNo").value=""),!1):!0}function validateJetBlue(a){var b=!0,c=document.getElementById("txtthirdPartyNo");return a.length<9&&0!=a.length&&(alert("Please enter a valid True Blue Number."),null!=c&&(c.value=""),b=!1),b}function fnSetOptIn(){var a=$("input:radio[name='gift-radio']:checked");$("#optInValue").val("0.0"===a.val()?"true":"false")}function fnSetCheckOptIn(){null!=document.getElementById("emailable")?$("#optInValue").val(document.getElementById("emailable").checked?"false":"true"):fnSetOptIn()}function fnSetPreference(){null!=document.getElementById("update-unlimited-preference")&&(document.getElementById("update-unlimited-preference").checked?($("#update-unlimited-preference").val("true"),$("#update-preference").val("true")):($("#update-unlimited-preference").val("false"),$("#update-preference").val("false")))}function addValuetoSelect(a,b,c){var d=document.createElement("OPTION");d.text=trim(b),d.value=trim(c),a.options.add(d)}function copyFieldDetails(a){document.getElementById("billingAdrsChkBox").checked&&(document.getElementById("shippingFirstName1").value=document.getElementById("firstName").value,document.getElementById("shippingLastName1").value=document.getElementById("lastName").value,document.getElementById("shippingCompanyName1").value=document.getElementById("billingAdrsCompany").value,document.getElementById("shippingAddress11").value=document.getElementById("billingAdrs1").value,document.getElementById("shippingAddress12").value=document.getElementById("billingAdrs2").value,document.getElementById("shippingZipCode1").value=document.getElementById("billZipCode").value,fnDisplayComplianceMsg(a,document.getElementById("statecode").value),document.getElementById("shippingCity1").value=document.getElementById("city").value,document.getElementById("shippingState1").value=document.getElementById("statecode").value,document.getElementById("shippingDay1").value=document.getElementById("billingDay").value,document.getElementById("shippingEvening1").value=document.getElementById("billingEvening").value)}function fnSetShippingId(){$("#tagId").val($("#countId").val())}function fnUpgradeCancel(){return null!=$("#contiUpgrade")&&$("#contiUpgrade").hide(),null!=$("#upgradePop").val()&&null!=$("#contiPopupShown").val()&&($("#upgradePop").val("false"),$("#contiPopupShown").val("true"),showContiPopup()),!1}function fnUpgrade(){return null!=$("#contiUpgrade")&&$("#contiUpgrade").hide(),null!=$("#upgradePop").val()&&null!=$("#contiPopupShown").val()&&($("#upgradePop").val("true"),$("#contiPopupShown").val("true"),showContiPopup()),!1}function successrecContiUpgradeEmailValidation(a,b,c,d,e){var f=trim(a).split("|"),g=f[0];userInfo.existing=f[0];var h=f[1],i=f[2],j=f[3];1==g?"true"==c?(1==i?null!=$("#errorLink").val()&&null!=$("#pop-up")?$("#pop-up").hide():(null!=$("#pop-up")&&$("#pop-up").hide(),"registered"!=$("#registered").val()?$("#contiApplicable").val("true"):"registered"==$("#registered").val()&&"true"==e&&$("#contiApplicable").val("true")):null!=$("#pop-up")&&$("#pop-up").hide(),null!=$("#messageForValidEmail")?(null!=document.getElementById("messageForValidEmail")&&(document.getElementById("messageForValidEmail").style.visibility="visible"),$("#messageForValidEmail").show(),null!=$("customerNo")&&$("customerNo").hide(),null!=$("#zip")&&$("#zip").hide(),null!=$("#confirm-order1")&&$("#confirm-order1").hide()):(null!=$("#customerNo")&&$("#customerNo").hide(),null!=$("#zip")&&$("#zip").hide(),null!=$("#confirm-order1")&&$("#confirm-order1").hide())):(1==i&&null!=$("#pop-up")&&$("#pop-up").hide(),$("#errorForExisting").show(),
$("#email").val(""),null!=$("#confirm-order1")&&$("#confirm-order1").show()):("true"==c&&(null!=$("#messageForValidEmail")?($("#messageForValidEmail").hide(),"true"==d&&(null!=$("customerNo")&&$("customerNo").show(),null!=$("#zip")&&$("#zip").show())):""==$("#brandAccount").val()?"true"==d&&(null!=$("customerNo")&&$("customerNo").show(),null!=$("#zip")&&$("#zip").show()):(null!=$("#zip")&&$("#zip").show(),$("#zip-verify").disabled="disabled")),1==i?null!=$("#errorLink").val()&&null!=$("#pop-up")?($("#conti-pop-up").show(),$("#contiApplicable").val("true")):$("#contiApplicable").val("true"):null!=$("#pop-up")&&$("#pop-up").hide(),null!=$("#confirm-order1")&&$("#confirm-order1").show()),1==h&&null!=$("#dateOfBirth")?$("#dateOfBirth").hide():$("#dateOfBirth").show(),$.ajax({type:"POST",url:"/jsp/offer/recr/us/common/recofferAjaxUnlimitedShipping.jsp",data:"profileItem="+j,success:function(a){var b=$("<div>").html(a).find(".unlimited-container").html();null!=$(".unlimited-ship-bill-container")&&$(".unlimited-ship-bill-container").html(b)},error:function(){}})}function showContiPopup(){return null!=$("#contiApplicable").val()&&null!=$("#contiPopupShown").val()&&"false"==$("#contiPopupShown").val()&&"true"==$("#contiApplicable").val()&&null!=$("#pop-up")?($("#pop-up").click(),!1):($("#Chkout_btnConfirmOrder").click(),!0)}function fnCheckOnClick(){$("#contiPopUpClick").val("true")}function populateLPMultiCityState(a,b,c,d,e,f){return fnValidate(a)?void getLPMultiCityState(a,document.getElementById(b),document.getElementById(c),d,e,f):(document.getElementById(b).value="",document.getElementById(c).value="",!1)}function copyTextDetails(a){$.each(a,function(){this.dest.val(this.src.val())})}function fnWinePlanMsg(){return alert("\nNeed to change your address for all of your wine plans? Please visit the wine plan selection page to make the switch."),!0}function fnValidatePOBox(a,b){return!0}function fnAssignPay(){var a=document.getElementById("WPPaymentUpdate"),b=document.getElementById("WPUpdate_Pay");return null!=a&&null!=b&&("true"==a.value?b.value="true":b.value="false"),!0}var ajaxService=function(){this.url="",this.type="GET",this.async="true",this.cache="true",this.dataType="text"};ajaxService.prototype.processAJAXRequest=function(a){var b=this;jQuery.extend(b,a),jQuery.ajax({url:b.url,async:b.async,type:b.type,cache:b.cache,data:b.data,success:function(a,c,d){"function"==typeof b.successCallback&&b.successCallback(jQuery.trim(a),d)},error:function(a,c){"function"==typeof b.errorCallback&&b.errorCallback(a,c)}})},$("#labelMsg").keyup(function(){var a=parseInt($(this).attr("maxlength")),b=$(this).val(),c=b.length;if(c>a){var d=b.substr(0,a);$(this).val(d)}});var triggerOverlay=null;$(function(){null!=$("#isError")&&$("#isError").val()&&emailValidation()}),$(function(){$("#frmcheckout").submit(function(){if($("#voucherCodeLP").length>0&&$("#voucherCodeLP").val().length>0)return alert("Please click on Apply Code button to claim your voucher"),!1;var a=$(this).find("input:radio.recrRadiobx:checked");if(a.length>0){var b=a.parent("li").find("input:text.recrQtyCls");""!=$.trim(b.val())&&$("#quantity").val(b.val())}})}),$(function(){function a(a,c){var d=trim(a).split("|"),e=d[0],f=d[1];alert(e);var g=$("#voucherCodeLP").val();g.length>0&&$("#voucherCodeLP").val(""),f&&b()}function b(){$("#cashVoucherCheck").load("/jsp/offer/recr/common/fetchVoucher.jsp",function(){$("#payThroughCashVoucherFlag").val(Boolean($("#cashVoucherFlag").val())),$("#remainingVoucherAmt").val(parseFloat($("#voucherAmount").val()))})}$("#voucherApplyCode").click(function(){var b=$("#voucherCodeLP").val();if(0==b.length)return alert("Please enter Voucher Code"),!1;var c="";0!=$("#voucherPinLP").length&&0!=$("#voucherPinLP").val()&&(c=$("#voucherPinLP").val());var d=new ajaxService,e={url:"/jsp/checkout/common/makeVoucherMine.jsp",data:"voucherCode="+b+"&pinPassword="+c,type:"GET",successCallback:function(b,c){a(b,c)}};return d.processAJAXRequest(e),!1}),0!=$("#cashVoucherFlag").length&&0!=$("#voucherAmount").length&&0!=$("#payThroughCashVoucherFlag").length&&0!=$("#remainingVoucherAmt").length&&($("#payThroughCashVoucherFlag").val(Boolean($("#cashVoucherFlag").val())),$("#remainingVoucherAmt").val(parseFloat($("#voucherAmount").val())))}),jQuery(document).ready(function(){function a(){$(".progress-shipping").click(function(){return r=confirm("If you leave this page, your information will be lost.  Do you wish to continue?"),r===!0?redirect("shipping_billing_address.jsp"):!1}),$(".progress-cart").click(function(){return r=confirm("If you leave this page, your information will be lost.  Do you wish to continue?"),r===!0?redirect("shoppingcart.jsp"):!1})}function b(){$(".js-choice-of-one input[type=radio]").change(c),$(".js-choice-of-two input[type=checkbox]").change(d)}function c(a){var b=$(this),c=b.closest("tr"),d=b.closest(".js-choice-of-one"),e=b.prop("checked");if(d.find("tr").each(function(){$(this).data("counter")||$(this).data("counter",1)}),e){var f=1;d.find("tr").each(function(){$(this).data("counter")>f&&(f=$(this).data("counter"))}),c.data("counter",f+1);var g=f;d.find("tr").each(function(){$(this).data("counter")==g&&($(this).data("counter",1),$(this).find("input[type=radio]").prop("checked",!1))})}else c.data("counter",1)}function d(a){var b=$(this),c=b.closest("tr"),d=b.closest(".js-choice-of-two"),e=b.prop("checked");if(d.find("tr").each(function(){$(this).data("counter")||$(this).data("counter",1)}),e){var f=1;d.find("tr").each(function(){$(this).data("counter")>f&&(f=$(this).data("counter"))}),c.data("counter",f+1);var g=f-1;d.find("tr").each(function(){$(this).data("counter")==g&&($(this).data("counter",1),$(this).find("input[type=checkbox]").prop("checked",!1))})}else c.data("counter",1)}a(),$("#add-shipping-button").click(function(){return $("#addShipping").modal(),$("#edit-shipping-address").hide("slow"),!1}),$("*[id*='edit-modal']").click(function(){var a=$(this).attr("class");if(a.indexOf("edit-billing-address")>0)$("#edit-shipping-address").modal(),$("#addShipping").hide("slow");else{var b=$("#edit-shipping-address");"undefined"!=typeof b&&null!=b&&-1==a.indexOf("shippingAddressClass")?$("#edit-shipping-address").modal():$("#edit-shipping_reg").modal(),$("#addShipping").hide("slow")}return!1}),$("#edit-billing").click(function(){return $("#editBilling").modal(),!1}),$("#add-new-payment").click(function(){return $("#add-payment").modal(),!1}),$(function(){b()})}),$(document).ready(function(){$(".modal .close").on("click",function(){$("#state-compliance-modal").hide()})});var userInfo={existing:"",isExisting:function(){return"1"==userInfo.existing}};$(function(){""==$("#isUpgradeApplicable").val()||"false"==$("#isUpgradeApplicable").val()?$("#confirmButton").show():null!=$("#contiPopupShown").val()&&"true"==$("#contiPopupShown").val()&&null!=$("#confirmButton")&&$("#confirmButton").show()});